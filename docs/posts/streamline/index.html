<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Masumbuko Semba">
<meta name="dcterms.date" content="2023-05-20">

<title>ng’ara - Streamlines for Surface Currents in Coastal Waters of Western Indian Ocean Region</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../ngara.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XCGZZVKFDT"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XCGZZVKFDT', { 'anonymize_ip': true});
</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="ng’ara - Streamlines for Surface Currents in Coastal Waters of Western Indian Ocean Region">
<meta name="twitter:description" content="Coding for all for better today and tommorow">
<meta name="twitter:image" content="https://lugoga.github.io/semba-quarto/posts/streamline/streamline.png">
<meta name="twitter:creator" content="@semba753">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="394">
<meta name="twitter:image-width" content="679">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ng’ara</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/lugoga"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/semba2020"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/channel/UC9uZ1KPyo7zIzI4BnUtHPfA"> <i class="bi bi-youtube" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-apps--links" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Apps &amp; Links</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-apps--links">    
        <li>
    <a class="dropdown-item" href="https://semba.netlify.app/">
 <span class="dropdown-text">Semba-blog Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://semba-blog.netlify.app/">
 <span class="dropdown-text">Semba Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://semba.shinyapps.io/kwala/">
 <span class="dropdown-text">Kwala commercial CIty</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://semba.shinyapps.io/coastal_dashboard/">
 <span class="dropdown-text">Marine Hub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://nemp.shinyapps.io/nemp/">
 <span class="dropdown-text">Environmental Master Plan</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://semba.shinyapps.io/OceanWebApp/">
 <span class="dropdown-text">Hydrographic Data Hub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://semba.shinyapps.io/marineTz/">
 <span class="dropdown-text">Potential Fishing Zones</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://semba.shinyapps.io/vizingaApp/">
 <span class="dropdown-text">TAFIRI Apps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rweekly.org/">
 <span class="dropdown-text">R Weekly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.r-bloggers.com/">
 <span class="dropdown-text">R Bloggers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.tmbish.me/lab/highcharter-cookbook/">
 <span class="dropdown-text">Highcharter</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../archive.html"> 
<span class="menu-text">Archive</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#streamline" id="toc-streamline" class="nav-link active" data-scroll-target="#streamline">Streamline</a></li>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">Dataset</a></li>
  <li><a href="#binning" id="toc-binning" class="nav-link" data-scroll-target="#binning">Binning</a>
  <ul class="collapse">
  <li><a href="#visualising-vector-field" id="toc-visualising-vector-field" class="nav-link" data-scroll-target="#visualising-vector-field">Visualising Vector field</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  <li><a href="#cited-sources" id="toc-cited-sources" class="nav-link" data-scroll-target="#cited-sources">Cited sources</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Streamlines for Surface Currents in Coastal Waters of Western Indian Ocean Region</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Spatial</div>
    <div class="quarto-category">Analysis</div>
    <div class="quarto-category">Visualization</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://semba.netlify.app">Masumbuko Semba</a> <a href="https://orcid.org/0000-0002-5002-9747" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://semba.netlify.app/">
            Nelson Mandela African Institution of Science and Technology
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 20, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XCGZZVKFDT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XCGZZVKFDT');
</script>
<section id="streamline" class="level2">
<h2 class="anchored" data-anchor-id="streamline">Streamline</h2>
<p>Streamlines are imaginary lines that are tangent to the velocity vector at every point in space. They represent the path that a fluid particle would follow if it were released into the flow. The density of streamlines represents the speed of the fluid at each point.</p>
<p>Streamlines are a powerful visualization tool used to understand fluid flow patterns. They are a series of lines that show the direction and magnitude of fluid motion at every point in space. Streamlines are commonly used in fields such as aerodynamics, hydrodynamics, and meteorology to analyze and visualize fluid flow patterns.</p>
<p>In this blog post, we will describe how to plot streamlines for surface current using R language. We will use the coastal waters of the Western Indian Ocean region as a case study, using drifter data from GDP. I will show you how to visualize vector field of ocean surface current using the <em>ggplot2</em> package <span class="citation" data-cites="ggplot">(<a href="#ref-ggplot" role="doc-biblioref">Wickham, 2016</a>)</span>.</p>
<p>I will further highlight the drawbacks of the default <em>geom</em> of <strong>ggplot2</strong> and why sometimes <strong>ggplot2</strong> functions fail to produce elegant oceanographic plots. Last I will illustrate the use of alternative <em>geoms</em> from <strong>metR</strong> package <span class="citation" data-cites="metr">(<a href="#ref-metr" role="doc-biblioref">Campitelli, 2019</a>)</span> to overcome the challenges inherited in <strong>ggplot2</strong> package.</p>
<p>In R, loading packages is an essential step to access additional functionality and tools for data manipulation, visualization, and analysis. The chunk below load the packages needed in this post;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">require</span>(metR)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">require</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">require</span>(oce)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">require</span>(sf)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">require</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We aslo need a basemap for our area of interest. I simply load the world map spatial object from the <em>spData</em> package and then uses the <em>sf</em> package’s <code>st_crop()</code> function to extract a the East African land mass of the world map based on specified minimum and maximum values for the longitude and latitude coordinates. The resulting spatial object, <code>wio</code>, represents the cropped WIO region area.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>world <span class="ot">=</span> spData<span class="sc">::</span>world</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a>wio <span class="ot">=</span> world <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="fu">st_crop</span>(<span class="at">xmin =</span><span class="dv">35</span> , <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">15</span>, <span class="at">xmax =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="sc">-</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dataset" class="level2">
<h2 class="anchored" data-anchor-id="dataset">Dataset</h2>
<p>To illustrate the concept, I am going to use drifter data from Global Drifter Program (GDP). Drifters are oceanographic instruments that are used to track the movement of surface currents. They consist of a buoy that floats on the ocean’s surface, and a drogue that is attached to the buoy and trails behind it at a depth of 15 meters. The drogue is designed to move with the water, providing an accurate measurement of the surface current.</p>
<p>The Drifter dataset comprises information on surface current velocity associated with geographical locations. This spatial data allows us to gain insights into the distribution of high-speed and low-speed currents in the ocean. Visualizing this data within a geospatial context, such as displaying it on an accurate map, is beneficial. I have filtered the data to focus on the western region of the tropical Indian Ocean. I have organized and structured the drifter information into a data frame, which is a tabular representation consisting of variables (columns) and observations (rows). The dataset encompasses surface current observations worldwide, collected by the Global Drifter Program across major oceans. The <a href="#tbl-tab1" class="quarto-xref">Table&nbsp;1</a> displays some of the variables included in the dataset.</p>
<ul>
<li>id: a unique number of drifter</li>
<li>lon: longitude information</li>
<li>lat: latitude information</li>
<li>year, month, day, hour of the drifter records</li>
<li>u: the zonal component of surface current</li>
<li>v: the meridional component of the surface current</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">load</span>(<span class="st">"drifter_split.RData"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>drifter.split<span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(drogue, season, sst)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">sample_n</span>(<span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="#cb3-7"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>,<span class="at">caption =</span> <span class="st">"A sample of drifter dataset"</span>, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"c"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>  kableExtra<span class="sc">::</span><span class="fu">column_spec</span>(<span class="at">column =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">width =</span> <span class="st">"3cm"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>  kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">""</span>, <span class="st">"Location"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Date Records"</span> <span class="ot">=</span> <span class="dv">4</span>,  <span class="st">"Current"</span> <span class="ot">=</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tab1" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tab1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: A sample of drifter dataset of the WIO region
</figcaption>
<div aria-describedby="tbl-tab1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<table class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A sample of drifter dataset</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Location
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Date Records
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Current
</div></th>
</tr>
<tr class="odd">
<th style="text-align: center;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">lon</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">lat</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">month</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">day</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">hour</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">u</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">v</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; width: 3cm;">114807</td>
<td style="text-align: center; width: 3cm;">51.19</td>
<td style="text-align: center; width: 3cm;">-16.58</td>
<td style="text-align: center; width: 3cm;">2013</td>
<td style="text-align: center; width: 3cm;">6</td>
<td style="text-align: center; width: 3cm;">7</td>
<td style="text-align: center; width: 3cm;">0</td>
<td style="text-align: center; width: 3cm;">0.23</td>
<td style="text-align: center; width: 3cm;">0.19</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 3cm;">63945810</td>
<td style="text-align: center; width: 3cm;">50.99</td>
<td style="text-align: center; width: 3cm;">-4.53</td>
<td style="text-align: center; width: 3cm;">2017</td>
<td style="text-align: center; width: 3cm;">12</td>
<td style="text-align: center; width: 3cm;">30</td>
<td style="text-align: center; width: 3cm;">18</td>
<td style="text-align: center; width: 3cm;">0.53</td>
<td style="text-align: center; width: 3cm;">0.52</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 3cm;">64726990</td>
<td style="text-align: center; width: 3cm;">40.03</td>
<td style="text-align: center; width: 3cm;">-6.82</td>
<td style="text-align: center; width: 3cm;">2017</td>
<td style="text-align: center; width: 3cm;">7</td>
<td style="text-align: center; width: 3cm;">1</td>
<td style="text-align: center; width: 3cm;">18</td>
<td style="text-align: center; width: 3cm;">-0.64</td>
<td style="text-align: center; width: 3cm;">1.40</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 3cm;">109535</td>
<td style="text-align: center; width: 3cm;">47.32</td>
<td style="text-align: center; width: 3cm;">-5.43</td>
<td style="text-align: center; width: 3cm;">2014</td>
<td style="text-align: center; width: 3cm;">11</td>
<td style="text-align: center; width: 3cm;">20</td>
<td style="text-align: center; width: 3cm;">18</td>
<td style="text-align: center; width: 3cm;">-0.13</td>
<td style="text-align: center; width: 3cm;">-0.26</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 3cm;">9727912</td>
<td style="text-align: center; width: 3cm;">42.50</td>
<td style="text-align: center; width: 3cm;">-9.83</td>
<td style="text-align: center; width: 3cm;">1998</td>
<td style="text-align: center; width: 3cm;">10</td>
<td style="text-align: center; width: 3cm;">3</td>
<td style="text-align: center; width: 3cm;">6</td>
<td style="text-align: center; width: 3cm;">-0.08</td>
<td style="text-align: center; width: 3cm;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 3cm;">25006</td>
<td style="text-align: center; width: 3cm;">52.43</td>
<td style="text-align: center; width: 3cm;">-11.27</td>
<td style="text-align: center; width: 3cm;">2001</td>
<td style="text-align: center; width: 3cm;">8</td>
<td style="text-align: center; width: 3cm;">5</td>
<td style="text-align: center; width: 3cm;">12</td>
<td style="text-align: center; width: 3cm;">-0.27</td>
<td style="text-align: center; width: 3cm;">0.11</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 3cm;">63356010</td>
<td style="text-align: center; width: 3cm;">45.10</td>
<td style="text-align: center; width: 3cm;">-6.74</td>
<td style="text-align: center; width: 3cm;">2017</td>
<td style="text-align: center; width: 3cm;">4</td>
<td style="text-align: center; width: 3cm;">16</td>
<td style="text-align: center; width: 3cm;">18</td>
<td style="text-align: center; width: 3cm;">0.64</td>
<td style="text-align: center; width: 3cm;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 3cm;">63816</td>
<td style="text-align: center; width: 3cm;">51.43</td>
<td style="text-align: center; width: 3cm;">-4.45</td>
<td style="text-align: center; width: 3cm;">2009</td>
<td style="text-align: center; width: 3cm;">10</td>
<td style="text-align: center; width: 3cm;">23</td>
<td style="text-align: center; width: 3cm;">12</td>
<td style="text-align: center; width: 3cm;">0.17</td>
<td style="text-align: center; width: 3cm;">0.31</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 3cm;">45979</td>
<td style="text-align: center; width: 3cm;">44.52</td>
<td style="text-align: center; width: 3cm;">-12.50</td>
<td style="text-align: center; width: 3cm;">2005</td>
<td style="text-align: center; width: 3cm;">5</td>
<td style="text-align: center; width: 3cm;">14</td>
<td style="text-align: center; width: 3cm;">0</td>
<td style="text-align: center; width: 3cm;">-0.37</td>
<td style="text-align: center; width: 3cm;">-0.19</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 3cm;">52953</td>
<td style="text-align: center; width: 3cm;">47.45</td>
<td style="text-align: center; width: 3cm;">-11.91</td>
<td style="text-align: center; width: 3cm;">2005</td>
<td style="text-align: center; width: 3cm;">1</td>
<td style="text-align: center; width: 3cm;">16</td>
<td style="text-align: center; width: 3cm;">12</td>
<td style="text-align: center; width: 3cm;">-0.09</td>
<td style="text-align: center; width: 3cm;">-0.11</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 3cm;">63071</td>
<td style="text-align: center; width: 3cm;">50.12</td>
<td style="text-align: center; width: 3cm;">-4.17</td>
<td style="text-align: center; width: 3cm;">2008</td>
<td style="text-align: center; width: 3cm;">1</td>
<td style="text-align: center; width: 3cm;">10</td>
<td style="text-align: center; width: 3cm;">18</td>
<td style="text-align: center; width: 3cm;">0.15</td>
<td style="text-align: center; width: 3cm;">-0.13</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 3cm;">61478290</td>
<td style="text-align: center; width: 3cm;">53.84</td>
<td style="text-align: center; width: 3cm;">-12.38</td>
<td style="text-align: center; width: 3cm;">2016</td>
<td style="text-align: center; width: 3cm;">1</td>
<td style="text-align: center; width: 3cm;">4</td>
<td style="text-align: center; width: 3cm;">18</td>
<td style="text-align: center; width: 3cm;">-0.32</td>
<td style="text-align: center; width: 3cm;">-0.03</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</figure>
</div>
</div>
<p>The drifter observations in the specified area, as illustrated in <a href="#fig-fig1" class="quarto-xref">Figure&nbsp;1</a>, were randomly scattered. To facilitate analysis and visualization, it is necessary to apply binning, which involves creating a grid with equally sized cells across the area. This binning process enables the organization of observations into a structured grid, allowing for easier interpretation and further exploration of the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="do">## convert drifter observation into simple features</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>drifter.split.sf <span class="ot">=</span> drifter.split <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">st_set_crs</span>(<span class="dv">4326</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> drifter.split <span class="sc">%&gt;%</span> <span class="fu">filter</span>(season <span class="sc">==</span> <span class="st">"SE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3"></a>               <span class="fu">sample_frac</span>(.<span class="dv">05</span>), <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat))<span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> wio, <span class="at">fill =</span> <span class="st">"lightgrey"</span>, <span class="at">col =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">coord_sf</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">12.5</span>,<span class="sc">-</span><span class="dv">3</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">36</span>, <span class="dv">48</span>))<span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">colour =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-fig1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: The distribution of drifter observation within the area
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="binning" class="level2">
<h2 class="anchored" data-anchor-id="binning">Binning</h2>
<p>To plot streamlines in R, we first need to create a grid of points that covers the area of interest. We can do this using the <code>st_make_grid</code> function from the <em>sf</em> package. The <code>st_make_grid</code> function takes two vectors as input and returns the area divided into equal size grids show in in <a href="#fig-fig2" class="quarto-xref">Figure&nbsp;2</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="do">## divide the tropical indian ocean region into grids</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>drifter.grid <span class="ot">=</span> drifter.split.sf <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">st_make_grid</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">30</span>))<span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">st_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="do">## </span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_sf</span>(<span class="at">data =</span> drifter.grid)<span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> wio,<span class="at">fill =</span> <span class="st">"lightgrey"</span>, <span class="at">col =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">coord_sf</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">12.5</span>,<span class="sc">-</span><span class="fl">4.5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">36</span>, <span class="dv">48</span>))<span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">colour =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-fig2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Gridded area to fill drifter observations
</figcaption>
</figure>
</div>
</div>
</div>
<p>Subsequently, after performing the binning process to organize the randomly distributed drifter observations into a grid, we can proceed with further computations. Specifically, we can calculate the number of drifters present in each individual grid cell, providing valuable insights into the density and distribution patterns across the area. Additionally, we can analyze the binned observations to determine the mean zonal (east-west) and meridional (north-south) velocity fields. Since we have split drifter data into northeast (NE) and southeast (SE) monsoon season, let’s begin with NE season;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>drifter.split.sf.ne <span class="ot">=</span> drifter.split.sf<span class="sc">%&gt;%</span> <span class="fu">filter</span>(season <span class="sc">==</span><span class="st">"NE"</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>drifter.gridded <span class="ot">=</span> drifter.grid <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(), </span>
<span id="cb8-5"><a href="#cb8-5"></a>         <span class="at">contained =</span> <span class="fu">lapply</span>(<span class="fu">st_contains</span>(<span class="fu">st_sf</span>(geometry),drifter.split.sf.ne),identity),</span>
<span id="cb8-6"><a href="#cb8-6"></a>         <span class="at">obs =</span> <span class="fu">sapply</span>(contained, length),</span>
<span id="cb8-7"><a href="#cb8-7"></a>         <span class="at">u =</span> <span class="fu">sapply</span>(contained, <span class="cf">function</span>(x) {<span class="fu">median</span>(drifter.split.sf.ne[x,]<span class="sc">$</span>u, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)}),</span>
<span id="cb8-8"><a href="#cb8-8"></a>         <span class="at">v =</span> <span class="fu">sapply</span>(contained, <span class="cf">function</span>(x) {<span class="fu">median</span>(drifter.split.sf.ne[x,]<span class="sc">$</span>v, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)}))</span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a>drifter.gridded <span class="ot">=</span> drifter.gridded <span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="fu">select</span>(obs, u, v) <span class="sc">%&gt;%</span> </span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a>coordinates <span class="ot">=</span> drifter.gridded <span class="sc">%&gt;%</span> </span>
<span id="cb8-15"><a href="#cb8-15"></a>  <span class="fu">st_centroid</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-16"><a href="#cb8-16"></a>  <span class="fu">st_coordinates</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-17"><a href="#cb8-17"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)</span>
<span id="cb8-18"><a href="#cb8-18"></a></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="fu">st_geometry</span>(drifter.gridded) <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb8-20"><a href="#cb8-20"></a></span>
<span id="cb8-21"><a href="#cb8-21"></a>current.gridded.ne <span class="ot">=</span> coordinates <span class="sc">%&gt;%</span> </span>
<span id="cb8-22"><a href="#cb8-22"></a>  <span class="fu">bind_cols</span>(drifter.gridded)<span class="sc">%&gt;%</span> </span>
<span id="cb8-23"><a href="#cb8-23"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="st">"NE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, the same process is done for the southeast monsoon season</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>drifter.split.sf.se <span class="ot">=</span> drifter.split.sf<span class="sc">%&gt;%</span> <span class="fu">filter</span>(season<span class="sc">==</span><span class="st">"SE"</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a>drifter.gridded <span class="ot">=</span> drifter.grid <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(), <span class="at">contained =</span> <span class="fu">lapply</span>(<span class="fu">st_contains</span>(<span class="fu">st_sf</span>(geometry),drifter.split.sf.se),identity),</span>
<span id="cb9-5"><a href="#cb9-5"></a>         <span class="at">obs =</span> <span class="fu">sapply</span>(contained, length),</span>
<span id="cb9-6"><a href="#cb9-6"></a>         <span class="at">u =</span> <span class="fu">sapply</span>(contained, <span class="cf">function</span>(x) {<span class="fu">median</span>(drifter.split.sf.se[x,]<span class="sc">$</span>u, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)}),</span>
<span id="cb9-7"><a href="#cb9-7"></a>         <span class="at">v =</span> <span class="fu">sapply</span>(contained, <span class="cf">function</span>(x) {<span class="fu">median</span>(drifter.split.sf.se[x,]<span class="sc">$</span>v, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)})) </span>
<span id="cb9-8"><a href="#cb9-8"></a></span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a>drifter.gridded <span class="ot">=</span> drifter.gridded <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="fu">select</span>(obs, u, v) <span class="sc">%&gt;%</span> </span>
<span id="cb9-12"><a href="#cb9-12"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="do">## obtain the centroid coordinates from the grid as table</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>coordinates <span class="ot">=</span> drifter.gridded <span class="sc">%&gt;%</span> </span>
<span id="cb9-16"><a href="#cb9-16"></a>  <span class="fu">st_centroid</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-17"><a href="#cb9-17"></a>  <span class="fu">st_coordinates</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-18"><a href="#cb9-18"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-19"><a href="#cb9-19"></a>  <span class="fu">rename</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)</span>
<span id="cb9-20"><a href="#cb9-20"></a></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="do">## remove the geometry from the simple feature of gridded drifter dataset</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="fu">st_geometry</span>(drifter.gridded) <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb9-23"><a href="#cb9-23"></a></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="do">## stitch together the extracted coordinates and drifter information int a single table for SE monsoon season</span></span>
<span id="cb9-25"><a href="#cb9-25"></a>current.gridded.se <span class="ot">=</span> coordinates <span class="sc">%&gt;%</span> </span>
<span id="cb9-26"><a href="#cb9-26"></a>  <span class="fu">bind_cols</span>(drifter.gridded) <span class="sc">%&gt;%</span> </span>
<span id="cb9-27"><a href="#cb9-27"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="st">"SE"</span>)</span>
<span id="cb9-28"><a href="#cb9-28"></a></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="do">## bind the gridded table for SE and NE</span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="do">## Note that similar NE follow similar procedure, hence not shown in the post</span></span>
<span id="cb9-31"><a href="#cb9-31"></a>drifter.current.gridded <span class="ot">=</span> current.gridded.ne <span class="sc">%&gt;%</span> </span>
<span id="cb9-32"><a href="#cb9-32"></a>  <span class="fu">bind_rows</span>(current.gridded.se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Upon analyzing the number of observations and velocity field within each grid cell, it became evident that certain grids lacked any drifter observations. To ensure smooth visualization, it was crucial to address this issue by filling these empty grids with appropriate U and V values. To accomplish this, an interpolation technique was employed. By applying interpolation, the missing U and V values were estimated for the empty grids, enabling a more seamless visualization of the data. The provided code chunk highlights the implementation of the interpolation process.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="do">## select grids for SE season only</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>drf.se <span class="ot">=</span> drifter.current.gridded <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">filter</span>(season <span class="sc">==</span> <span class="st">"SE"</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="do">## interpolate the U component</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>u.se <span class="ot">=</span> <span class="fu">interpBarnes</span>(<span class="at">x =</span> drf.se<span class="sc">$</span>x, <span class="at">y =</span> drf.se<span class="sc">$</span>y, <span class="at">z =</span> drf.se<span class="sc">$</span>u)</span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="do">## obtain dimension that determine the width (ncol) and length (nrow) for tranforming wide into long format table</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>dimension <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">lon =</span> u.se<span class="sc">$</span>xg, u.se<span class="sc">$</span>zg) <span class="sc">%&gt;%</span> <span class="fu">dim</span>()</span>
<span id="cb10-10"><a href="#cb10-10"></a></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="do">## make a U component data table from interpolated matrix</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>u.tb <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">lon =</span> u.se<span class="sc">$</span>xg, </span>
<span id="cb10-13"><a href="#cb10-13"></a>                  u.se<span class="sc">$</span>zg) <span class="sc">%&gt;%</span> </span>
<span id="cb10-14"><a href="#cb10-14"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"lata"</span>, <span class="at">value =</span> <span class="st">"u"</span>, <span class="dv">2</span><span class="sc">:</span>dimension[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb10-15"><a href="#cb10-15"></a>  <span class="fu">mutate</span>(<span class="at">lat =</span> <span class="fu">rep</span>(u.se<span class="sc">$</span>yg, <span class="at">each =</span> dimension[<span class="dv">1</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb10-16"><a href="#cb10-16"></a>  <span class="fu">select</span>(lon,lat, u) <span class="sc">%&gt;%</span> <span class="fu">as.tibble</span>()</span>
<span id="cb10-17"><a href="#cb10-17"></a></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="do">## interpolate the V component</span></span>
<span id="cb10-19"><a href="#cb10-19"></a>v.se <span class="ot">=</span> <span class="fu">interpBarnes</span>(<span class="at">x =</span> drf.se<span class="sc">$</span>x, </span>
<span id="cb10-20"><a href="#cb10-20"></a>                    <span class="at">y =</span> drf.se<span class="sc">$</span>y, </span>
<span id="cb10-21"><a href="#cb10-21"></a>                    <span class="at">z =</span> drf.se<span class="sc">$</span>v)</span>
<span id="cb10-22"><a href="#cb10-22"></a></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="do">## make the V component data table from interpolated matrix</span></span>
<span id="cb10-24"><a href="#cb10-24"></a>v.tb <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">lon =</span> v.se<span class="sc">$</span>xg, v.se<span class="sc">$</span>zg) <span class="sc">%&gt;%</span> </span>
<span id="cb10-25"><a href="#cb10-25"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"lata"</span>, <span class="at">value =</span> <span class="st">"v"</span>, <span class="dv">2</span><span class="sc">:</span>dimension[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb10-26"><a href="#cb10-26"></a>  <span class="fu">mutate</span>(<span class="at">lat =</span> <span class="fu">rep</span>(v.se<span class="sc">$</span>yg, <span class="at">each =</span> dimension[<span class="dv">1</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb10-27"><a href="#cb10-27"></a>  <span class="fu">select</span>(lon,lat, v) <span class="sc">%&gt;%</span> </span>
<span id="cb10-28"><a href="#cb10-28"></a>  <span class="fu">as.tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once the zonal and meridional velocities have been filled in the grids, it becomes possible to calculate the velocity field at each individual grid point. This can be achieved by computing the magnitude of the velocity vector using the equation:</p>
<p><span class="math display">\[
vel = \sqrt{v^2 + u^2}
\]</span> In this equation, the variable <code>v</code> represents the meridional velocity component, while <code>u</code> represents the zonal velocity component. By taking the square root of the sum of the squares of these components, we obtain the magnitude of the velocity vector, denoted as <code>vel</code>. This magnitude represents the overall speed or intensity of the velocity at each point in the grid, providing valuable insights into the spatial variations and patterns of the velocity field. The provided code chunk highlights the computation of the velocity field.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="do">## stitch now the V component intot the U data table and compute the velocity</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>uv.se <span class="ot">=</span> u.tb <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">bind_cols</span>(v.tb <span class="sc">%&gt;%</span> <span class="fu">select</span>(v)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">mutate</span>(<span class="at">vel =</span> <span class="fu">sqrt</span>(u<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>v<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code takes two data frames, <code>u.tb</code> and <code>v.tb</code>, and combines them into a new data frame and compute the velocity of the surface current and store them in a new column called <code>ve</code> from the corresponding values from the u and v columns.</p>
<section id="visualising-vector-field" class="level3">
<h3 class="anchored" data-anchor-id="visualising-vector-field">Visualising Vector field</h3>
<p><a href="#fig-segment" class="quarto-xref">Figure&nbsp;3</a> was made with <strong>ggplot2</strong> package. The smoothed velocity grid was created with the <code>geom_raster()</code> function and the vector field showing the direction and speed superimposed on the current velocity was done with the <code>segment()</code> function. You notice that these geoms did a wonderful job and the figure is surface current speed and direction are clearly distinguished with the arrow and the length of the arrow. The code used to create <a href="#fig-segment" class="quarto-xref">Figure&nbsp;3</a> are shown in the chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> uv.se, <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat, <span class="at">fill =</span> vel), <span class="at">interpolate =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> uv.se, <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">xend =</span> lon <span class="sc">+</span> u<span class="sc">/</span><span class="fl">1.2</span>, <span class="at">y =</span> lat, <span class="at">yend =</span> lat<span class="sc">+</span>v<span class="sc">/</span><span class="fl">1.2</span>), </span>
<span id="cb12-4"><a href="#cb12-4"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(.<span class="dv">2</span>, <span class="st">"cm"</span>), <span class="at">type =</span> <span class="st">"open"</span>))<span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> wio,<span class="at">fill =</span> <span class="st">"lightgrey"</span>, <span class="at">col =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="fu">coord_sf</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">12.5</span>,<span class="sc">-</span><span class="fl">4.5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">48</span>))<span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">name =</span> <span class="st">"Current"</span>,<span class="at">colours =</span> <span class="fu">oceColorsVelocity</span>(<span class="dv">120</span>), </span>
<span id="cb12-8"><a href="#cb12-8"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.6</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">1.6</span>,.<span class="dv">3</span>),</span>
<span id="cb12-9"><a href="#cb12-9"></a>                       <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(<span class="at">barwidth =</span> .<span class="dv">8</span>, <span class="at">barheight =</span> <span class="dv">15</span>,</span>
<span id="cb12-10"><a href="#cb12-10"></a>                                              <span class="at">title =</span> <span class="fu">expression</span>(Current<span class="sc">~</span>speed<span class="sc">~</span>(ms<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>})), </span>
<span id="cb12-11"><a href="#cb12-11"></a>                                              <span class="at">title.position =</span> <span class="st">"right"</span>, <span class="at">title.hjust =</span> .<span class="dv">5</span>, </span>
<span id="cb12-12"><a href="#cb12-12"></a>                                              <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)))<span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb12-15"><a href="#cb12-15"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">1.4</span>, <span class="st">"cm"</span>), </span>
<span id="cb12-16"><a href="#cb12-16"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-17"><a href="#cb12-17"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">colour =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-segment" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-segment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-segment-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-segment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Vector field of speed and direction of surface current
</figcaption>
</figure>
</div>
</div>
</div>
<p>To plot the streamlines, i used <code>geom_streamline()</code> from <em>metR</em> package <span class="citation" data-cites="metr">(<a href="#ref-metr" role="doc-biblioref">Campitelli, 2019</a>)</span>. The <code>geom_streamline()</code> function takes the x and y coordinates of each point on the grid and the x and y components of the velocity vector as input and generates the streamlines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>  metR<span class="sc">::</span><span class="fu">geom_contour_fill</span>(<span class="at">data =</span> uv.se, <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat, <span class="at">z =</span> vel), </span>
<span id="cb13-3"><a href="#cb13-3"></a>                          <span class="at">na.fill =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">70</span>) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4"></a>  metR<span class="sc">::</span><span class="fu">geom_streamline</span>(<span class="at">data =</span> uv.se, </span>
<span id="cb13-5"><a href="#cb13-5"></a>                        <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat, <span class="at">dx =</span> u, <span class="at">dy =</span> v),</span>
<span id="cb13-6"><a href="#cb13-6"></a>                        <span class="at">L =</span> .<span class="dv">9</span>, <span class="at">res =</span> <span class="dv">4</span>, <span class="at">n =</span> <span class="dv">40</span>, <span class="at">jitter =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> wio,<span class="at">fill =</span> <span class="st">"lightgrey"</span>, <span class="at">col =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>  <span class="fu">coord_sf</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">12.5</span>,<span class="sc">-</span><span class="fl">4.5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">48</span>))<span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">name =</span> <span class="st">"Current"</span>,<span class="at">colours =</span> <span class="fu">oceColorsVelocity</span>(<span class="dv">120</span>), </span>
<span id="cb13-10"><a href="#cb13-10"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.6</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">1.6</span>,.<span class="dv">3</span>),</span>
<span id="cb13-11"><a href="#cb13-11"></a>                       <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(<span class="at">barwidth =</span> .<span class="dv">8</span>, <span class="at">barheight =</span> <span class="dv">15</span>,</span>
<span id="cb13-12"><a href="#cb13-12"></a>                                              <span class="at">title =</span> <span class="fu">expression</span>(Current<span class="sc">~</span>speed<span class="sc">~</span>(ms<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>})), </span>
<span id="cb13-13"><a href="#cb13-13"></a>                                              <span class="at">title.position =</span> <span class="st">"right"</span>, <span class="at">title.hjust =</span> .<span class="dv">5</span>, </span>
<span id="cb13-14"><a href="#cb13-14"></a>                                              <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)))<span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb13-17"><a href="#cb13-17"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">1.4</span>, <span class="st">"cm"</span>), </span>
<span id="cb13-18"><a href="#cb13-18"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-19"><a href="#cb13-19"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">colour =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-streamline" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-streamline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-streamline-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-streamline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Streamline of surface current superimposed on the current velocity raster
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>Many Oceanographic data are defined in a longitude–latitude grid and and though <code>geom_raster()</code> and <code>geom_segment()</code> plot these field well, but the function from <strong>metR</strong> package extend the use of ggplot to deal well with oceanographical data and produce graphics that meet the standard. The massless flow of surface current are much clear when stremline are used to plot the figure (<a href="#fig-massless" class="quarto-xref">Figure&nbsp;5</a>). The lines of codes used to make <a href="#fig-massless" class="quarto-xref">Figure&nbsp;5</a> are shown in the chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>metR<span class="sc">::</span><span class="fu">geom_streamline</span>(<span class="at">data =</span> uv.se, </span>
<span id="cb14-3"><a href="#cb14-3"></a>                        <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat, <span class="at">dx =</span> u, <span class="at">dy =</span> v, </span>
<span id="cb14-4"><a href="#cb14-4"></a>                            <span class="at">color =</span> <span class="fu">sqrt</span>(..dx..<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> ..dy..<span class="sc">^</span><span class="dv">2</span>), </span>
<span id="cb14-5"><a href="#cb14-5"></a>                            <span class="at">alpha =</span> ..step..),</span>
<span id="cb14-6"><a href="#cb14-6"></a>                      <span class="at">L =</span> <span class="dv">2</span>, <span class="at">res =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">40</span>, </span>
<span id="cb14-7"><a href="#cb14-7"></a>                      <span class="at">arrow =</span> <span class="cn">NULL</span>, <span class="at">lineend =</span> <span class="st">"round"</span>)<span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> wio,<span class="at">fill =</span> <span class="st">"lightgrey"</span>, <span class="at">col =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>  <span class="fu">coord_sf</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">12.5</span>,<span class="sc">-</span><span class="fl">4.5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">48</span>))<span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>  <span class="fu">scale_color_viridis_c</span>(</span>
<span id="cb14-11"><a href="#cb14-11"></a>    <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(<span class="at">barwidth =</span> .<span class="dv">8</span>, <span class="at">barheight =</span> <span class="dv">15</span>,</span>
<span id="cb14-12"><a href="#cb14-12"></a>                           <span class="at">title =</span> <span class="fu">expression</span>(Current<span class="sc">~</span>speed<span class="sc">~</span>(ms<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>})), </span>
<span id="cb14-13"><a href="#cb14-13"></a>                           <span class="at">title.position =</span> <span class="st">"right"</span>, <span class="at">title.hjust =</span> .<span class="dv">5</span>, </span>
<span id="cb14-14"><a href="#cb14-14"></a>                           <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)))<span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">1.5</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>  <span class="fu">scale_alpha</span>(<span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb14-19"><a href="#cb14-19"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">1.4</span>, <span class="st">"cm"</span>), </span>
<span id="cb14-20"><a href="#cb14-20"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-21"><a href="#cb14-21"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">colour =</span> <span class="dv">1</span>))<span class="sc">+</span>  </span>
<span id="cb14-22"><a href="#cb14-22"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-massless" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-massless-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-massless-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-massless-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: streamlines of surface current flow
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="cited-sources" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Cited sources</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-metr" class="csl-entry" role="listitem">
Campitelli, E., 2019. <a href="https://CRAN.R-project.org/package=metR">metR: Tools for easier analysis of meteorological fields</a>.
</div>
<div id="ref-ggplot" class="csl-entry" role="listitem">
Wickham, H., 2016. <a href="https://ggplot2.tidyverse.org">ggplot2: Elegant graphics for data analysis</a>. Springer-Verlag New York.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>