{
  "hash": "6faafe083761a4c17d7841cc55aac42a",
  "result": {
    "markdown": "---\ntitle: \"Compute Normalized Difference Vegetation Index in R \"\nauthor: \n  - name: Masumbuko Semba\n    url: https://semba.netlify.app\n    orcid: 0000-0002-5002-9747\n    affiliation: Nelson Mandela African Institution of Science and Technology\n    affiliation-url: https://semba.netlify.app/ \ndate: \"2023-04-28\"\ncategories: [Spatial, Analysis, Visualization]\ntags: \n  - Raster\n  - NVDI\n  - Landsat\nimage: \"ndvi.png\"\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\nbibliography: ../blog.bib\ncsl:  ../elsevier.csl\nexecute: \n  warning: false\n  echo: true\nfig-width: 7\nfig-height: 5\ncode-line-numbers: true\n\n---\n\n\n<!-- Google tag (gtag.js) -->\n<script async src=\"https://www.googletagmanager.com/gtag/js?id=G-XCGZZVKFDT\"></script>\n<script>\n  window.dataLayer = window.dataLayer || [];\n  function gtag(){dataLayer.push(arguments);}\n  gtag('js', new Date());\n\n  gtag('config', 'G-XCGZZVKFDT');\n</script>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::knit_hooks$set(crop = knitr::hook_pdfcrop)\n```\n:::\n\n\n\n## Introduction:\nIn this post, we're going to learn how to compute Normalized Difference Vegetation Index (NDVI) from Landsat imagery using R. NDVI is a widely used remote sensing index that measures the health and vigor of vegetation. It's calculated from the difference between near-infrared (NIR) and red reflectance values divided by their sum. NDVI values range from -1 to 1, with higher values indicating healthier vegetation. NDVI is an important tool for studying vegetation dynamics, land-use changes, and environmental monitoring.\n\nRemote sensing image are useful tool that provide satellite data covering a large area and with high frequency temporal resolution. Such satellite image include Landsat. Landsat imagery is a valuable source of data for NDVI calculation. The Landsat satellites collect data in multiple spectral bands, including red and NIR, which can be used to compute NDVI. \n\n\nIn this post, we'll walk through the steps of computing NDVI from Landsat imagery using R. R is a popular programming language for statistics and and provides a range of packages for processing Landsat imagery and computing NDVI. We'll cover how to load the Landsat bands, compute NDVI, write the NDVI raster to a file, and visualize the NDVI raster. By the end of this post, you'll be able to use R to calculate NDVI from Landsat imagery and use it for further analysis and visualization.\n\n\n## What is NDVI\nNormalized Difference Vegetation Index (NDVI) is a remote sensing index that measures the health and vigor of vegetation. It is widely used in environmental monitoring, land-use change detection, and vegetation dynamics studies. NDVI is calculated from remotely sensed reflectance values of red and near-infrared (NIR) bands using the following formula:\n\n\n$$\nNDVI = \\frac{NIR-Red}{NIR+Red}\n$$\n\nNDVI values range from -1 to 1, with higher values indicating healthier vegetation. Negative values indicate water bodies or non-vegetated areas, while zero values indicate bare soil or areas with very low vegetation cover. NDVI has several advantages over traditional field-based methods of vegetation monitoring, such as its ability to cover large areas at once, its ability to detect changes in vegetation cover over time, and its sensitivity to changes in vegetation health.\n\nLandsat imagery is a widely used source of data for NDVI calculation. Landsat is a series of Earth-observing satellites that collect data in multiple spectral bands, including red and NIR. The data can be downloaded for free from the United States Geological Survey (USGS) website.\n\n\nLets first load the package we are going to use in this post, if these packages are not installed in your machine, you can simply install them as they are found in CRAN\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(terra)\nrequire(tidyterra)\nrequire(tidyverse)\nrequire(sf)\nrequire(magrittr)\n```\n:::\n\n\n\nThen we load the Landsat bands. The **terra** package [@terra] has `rast` function which can load load the bands into the a single file. For illustration purpose, we will use landsat band from **spDataLarge** package [@spdata]. The chunk below highlight a code on how to load the file into our session:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmulti_rast = terra::rast(system.file(\"raster/landsat.tif\", package = \"spDataLarge\"))\nmulti_rast\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nclass       : SpatRaster \ndimensions  : 1428, 1128, 4  (nrow, ncol, nlyr)\nresolution  : 30, 30  (x, y)\nextent      : 301905, 335745, 4111245, 4154085  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / UTM zone 12N (EPSG:32612) \nsource      : landsat.tif \nnames       : landsat_1, landsat_2, landsat_3, landsat_4 \nmin values  :      7550,      6404,      5678,      5252 \nmax values  :     19071,     22051,     25780,     31961 \n```\n:::\n:::\n\n\nThe printed object is spatRaster object. SpatRaster is an object class in R that is used to represent spatial raster data. It is a three-dimensional array that contains data on different layers or bands, with the two spatial dimensions representing the row and column coordinates of the raster cells. In addition, our SpatRaster objects have several attributes that describe its spatial properties, such as extent, resolution, and projection.\n\nThe spatRaster object has four satellite bands - blue, green, red, and near-infrared (NIR). We can rename this band to their corresponding band names using **tidyterra** package [@tidyterra] function `rename`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmulti_rast = multi_rast %>% \n  rename(\n    blue = landsat_1,\n    green = landsat_2,\n    red = landsat_3,\n    nir = landsat_4\n  )\n\nmulti_rast\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nclass       : SpatRaster \ndimensions  : 1428, 1128, 4  (nrow, ncol, nlyr)\nresolution  : 30, 30  (x, y)\nextent      : 301905, 335745, 4111245, 4154085  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / UTM zone 12N (EPSG:32612) \nsource      : landsat.tif \nnames       :  blue, green,   red,   nir \nmin values  :  7550,  6404,  5678,  5252 \nmax values  : 19071, 22051, 25780, 31961 \n```\n:::\n:::\n\n\nOnce we have renamed the band with appropriate band names, our next step should be to compute the NDVI formula into an R function. Thanks again to **tidyterra** package that has simplified computation of spatRaster object using verbs similar to tidyverse package [@tidyverse]. For us we are going to compute the ndvi as separate band in the spatraster object using `mutate` function. NDVI can be computed using the formula mentioned above. Here's the code:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmulti_rast = multi_rast %>% \n  tidyterra::mutate(ndvi = (nir - red)/(nir + red))\n\nmulti_rast\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nclass       : SpatRaster \ndimensions  : 1428, 1128, 5  (nrow, ncol, nlyr)\nresolution  : 30, 30  (x, y)\nextent      : 301905, 335745, 4111245, 4154085  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / UTM zone 12N (EPSG:32612) \nsource(s)   : memory\nnames       :  blue, green,   red,   nir,       ndvi \nmin values  :  7550,  6404,  5678,  5252, -0.2352531 \nmax values  : 19071, 22051, 25780, 31961,  0.6076995 \n```\n:::\n:::\n\n\nThe printed spatRaster object has added a fifth layer as ndvi. The ndvi object now contains the computed NDVI values for each pixel. The computed NDVI raster can be visualized using various R packages, such as **rasterVis** or **ggplot2** [@ggplot]. Here's an example using **ggplot2** with additional function from **tidyterra** package: This code will produce a color-coded plot of the NDVI raster, with higher values shown in shades of green and lower values shown in shades of brown.\n\n\n\n\n::: {.cell crop='false'}\n\n```{.r .cell-code}\nggplot()+\n  tidyterra::geom_spatraster(data = multi_rast[[5]])+\n  scale_fill_gradientn(colours = hcl.colors(n = 5, palette = \"Red-Green\"), \n                       guide = guide_colorbar(reverse = TRUE, title = \"NDVI\")) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Computed NDVI with color gradient where green color indicate a greenish land cover](index_files/figure-html/fig-ndvi-1.png){#fig-ndvi width=672}\n:::\n:::\n\n## Summary\n\nIn this post, we'll walk through the steps of computing NDVI from Landsat imagery using R. Specifically, we'll cover how to load the Landsat bands, compute NDVI raster to a file, and visualize the NDVI raster. I hope the information in this post can help you to use R to calculate NDVI from Landsat imagery and use it for further analysis and visualization.\n\n\n## Cited sources\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}